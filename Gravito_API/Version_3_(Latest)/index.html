<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Version 3 (Latest) - Gravito Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Version 3 (Latest)";
        var mkdocs_page_input_path = "Gravito_API\\Version_3_(Latest).md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../img/logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Getting_started/Register/">Register</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Getting_started/Support/">Support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Getting_started/Release_Notes/">Release Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Consent Managment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Consent_Management/Iab_tcf/">IAB TCF</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Consent_Management/Google_consent_mode/">Google Consent Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Consent_Management/Microsoft_consent_mode/">Microsoft Consent Mode</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito CMP (New)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Setup_and_Design/">Setup and Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Customization/">Customization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Components/">Components</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Deployment/">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/FAQ/">FAQ's</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Release_Notes/">Release Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito SDK</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_SDK/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_SDK/Release_Notes/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_SDK/Version_2_%28Latest%29/">Version 2 (Latest)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito API</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Setup_and_Validation/">Setup and Validation</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Version 3 (Latest)</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#first-party-api-microprofile">First party API / Microprofile</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Version_2/">Version 2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Microprofile/">Microprofile</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CustomerdataApi/">Customer Data API</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Other Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Other_Features/Domain_Cookie_Scan/">Domain Cookie Scan</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Other_Features/GVL_Comparison/">GVL Comparison</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Try it out</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Try_it_out/Playbooks/">Playbooks</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Gravito Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Gravito API</li>
      <li class="breadcrumb-item active">Version 3 (Latest)</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="version-3-latest">Version 3 (Latest)</h1>
<h2 id="first-party-api-microprofile">First party API / Microprofile</h2>
<p>As discussed in the previous version 2, most common use for first party microprofile is to store CMP consents and other metadata on it. In version 3 we have added a whole new set of features to manage observations, consents and key rings with in the microprofile.</p>
<p>New features:</p>
<ul>
<li>Supports Key Rings, Consents and events</li>
<li>Data compression enabled by default</li>
<li>Third-party to First-party ID fusion</li>
<li>More options to get the audit trail.</li>
</ul>
<p>The data properties of the Version 3 of the api looks like below.</p>
<pre><code>{
  &quot;i&quot;: &quot;&lt;microprofileid&gt;&quot;,
  &quot;r&quot;: &quot;&lt;originDomain&gt;&quot;,
  &quot;v&quot;: &quot;v3&quot;,
  &quot;e&quot;: {
    &quot;key1&quot;: &quot;value1&quot;,
    &quot;key2&quot;: &quot;value2&quot;
  },
  &quot;k&quot;: [ //key value pairs
    {
      &quot;i&quot;: &quot;keyId&quot;,
      &quot;k&quot;: &quot;KeyName&quot;,
      &quot;v&quot;: &quot;keyValue&quot;,
      &quot;t&quot;: &lt;timestamp&gt;
    },
    {
      &quot;i&quot;: &quot;keyId&quot;,
      &quot;k&quot;: &quot;KeyName&quot;,
      &quot;v&quot;: &quot;keyValue&quot;,
      &quot;t&quot;: &lt;timestamp&gt;
    }
  ],
  &quot;c&quot;: [
    {
      &quot;i&quot;: &quot;consentId&quot;,
      &quot;c&quot;: &quot;consentName&quot;,
      &quot;s&quot;: true,
      &quot;t&quot;: &lt;timestamp&gt;
    },
    {
      &quot;i&quot;: &quot;consentId&quot;,
      &quot;c&quot;: &quot;consentName&quot;,
      &quot;s&quot;: true,
      &quot;t&quot;: &lt;timestamp&gt;
    }
  ]
}
</code></pre>
<p>The property values in the V3 are mainly short forms to reduce space in the requests. You can refer the full form here.</p>
<p>Timestamp for each entity is auto-generated by Gravito 1st party end point itself to help you keep track of different values when merging data across domains.</p>
<ul>
<li>k : Key Rings<ul>
<li>i: Key Id</li>
<li>k: Key Name</li>
<li>v: Key Value</li>
<li>t: Timestamp</li>
</ul>
</li>
<li>c: Consents<ul>
<li>i: Consent Id</li>
<li>k: Consent Name</li>
<li>v: Consent Value</li>
<li>t: Timestamp</li>
</ul>
</li>
<li>e: Events</li>
<li>i: Id</li>
<li>r: Referrer</li>
<li>v: version</li>
</ul>
<p>If there would be other needs to use microprofile to act as keyring store, store context analytics results (e.g. segments) or something similar, the calls to first party API microprofile would look something like this:</p>
<pre><code>(function gtoFirstPartyV3() {
    var xhr = new XMLHttpRequest();
    var params = {
    &quot;e&quot;: {},
    &quot;k&quot;: [],
    &quot;c&quot;: []
    };

    xhr.open(&quot;POST&quot;, &quot;https://gto.&lt;&lt;domain&gt;&gt;/api/v3/firstparty&quot;, true);
    xhr.withCredentials = true;
    xhr.onreadystatechange = function(response) {
        if(xhr.readyState == XMLHttpRequest.DONE &amp;&amp; xhr.status == 200) {
            console.log(&quot;1P Echo : &quot; + response.target.response);
        }
    }
    xhr.send(JSON.stringify(params));
})();
</code></pre>
<p>Please get in touch with is for a <em>detailed Postman collection</em> to get details of different use cases of this API. We will be happy to help. We can help you get started with sample GTM tag samples which enables simple profiling to complex cases which can enable Thirdparty to FirstParty Id fusion.</p>
<p>Connect cookies across domains</p>
<p>Under the Key value pair ("e"), similar to the version 2 you can still use the matchOnId to connect profiles to different domains. This for example can be done using a users Id when they login. (e.g. logged in user has UID known) </p>
<p>matchOnID is the only reserved key value pair, it allows retrieving the cookie set for particular ID (e.g. logged in user has UID known) from other domain. A user with a matchOnId can be dealt with in 3 different ways to change the particular Id associated in 3 different ways.</p>
<ul>
<li>reset<ul>
<li>Reset value for the matchOnId can be used to clear all the values from the events key value pair temporarily.</li>
</ul>
</li>
<li>disconnect<ul>
<li>Disconnect value for the matchOnId can be used to remove the matchOnId from the events key value pair.</li>
</ul>
</li>
<li>delete<ul>
<li>Delete keyword for the matchOnId can be used to delete the whole events and the existing microProfileId provided.</li>
<li>This operation will reset the microProfileId and give you a new one.</li>
</ul>
</li>
</ul>
<p>Note: In all these cases passing the matchOnId value for a particular ID (e.g. logged in user has UID known) can resurface the whole profile again for your convenience.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Setup_and_Validation/" class="btn btn-neutral float-left" title="Setup and Validation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Version_2/" class="btn btn-neutral float-right" title="Version 2">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../Setup_and_Validation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Version_2/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../js/modal.js"></script>
      <script src="../../js/motomo.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
