<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Microprofile - Gravito Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Microprofile";
        var mkdocs_page_input_path = "Gravito_API\\Microprofile.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../img/logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Getting_started/Register/">Register</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Getting_started/Support/">Support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Getting_started/Release_Notes/">Release Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito Intelligent CMP</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_Intelligent_CMP/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_Intelligent_CMP/Setup_and_Design/">Setup and Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_Intelligent_CMP/GTM_Template/">GTM Template</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_Intelligent_CMP/Release_Notes/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_Intelligent_CMP/Advanced_Features/">Advanced Features</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito TCF 2.2 CMP</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_TCF_2.2_CMP/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_TCF_2.2_CMP/Setup_and_Design/">Setup and Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_TCF_2.2_CMP/Mobile_apps/">Mobile apps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_TCF_2.2_CMP/Release_Notes/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_TCF_2.2_CMP/Advanced_features/">Advanced features</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito SDK</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_SDK/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_SDK/Release_Notes/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_SDK/Version_2_%28Latest%29/">Version 2 (Latest)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito API</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Setup_and_Validation/">Setup and Validation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Version_3_%28Latest%29/">Version 3 (Latest)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Version_2/">Version 2</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Microprofile</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CustomerdataApi/">Customer Data API</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Other Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Other_Features/Cookie_Scanner/">Cookie Scanner</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Other_Features/GVL_Comparison/">GVL Comparison</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Other_Features/Prebid_User_Id_Module/">Prebid User Id Module</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Try it out</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Try_it_out/Playbooks/">Playbooks</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Gravito Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Gravito API</li>
      <li class="breadcrumb-item active">Microprofile</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="microprofile">Microprofile</h1>
<p><strong>Microprofile which relies on Gravito Firstparty API v3 is in Beta testing</strong></p>
<p>Gravito Microprofile is sort of a synonym to first party API. First party API was initially developed as simple microservice to help with setting first party cookie to hold CMP settings and consents. As more advanced requirements started to surface we thought that calling the service “microprofile” would be reasonable.</p>
<p><strong>Micro means simple, right?</strong></p>
<p>Wish it was. However, the general idea is pretty simple. We store various types of attributes to a cookie that is set from server-side by API served from sub-domain associated with your domain. Two reasons why:</p>
<p>1) server-side cookie lasts longer than cookies set by javascript running on client2) API operating on your domain avoids the blocking of third party cookies (now and the future)</p>
<p><strong>How does it work?</strong></p>
<p>First learn about setting up <a href="https://www.gravito.net/docs/first-party-api/">First Party API</a>, after registering your domain(s) you are ready to roll: (Example provided based on <a href="https://www.gravito.net/docs/first-party-api/version-3/">Version 3</a>)</p>
<pre><code class="language-javascript">(function () { 
  var xhr = new XMLHttpRequest(); 
  var params = { 
  &quot;e&quot;: {
    &quot;matchOnId&quot;: &quot;dem05&quot;, 
    &quot;id1&quot;: &quot;xyz&quot;, 
    &quot;counterPageView&quot;:&quot;2&quot; 
  }, 
  &quot;k&quot;: [{
          &quot;i&quot;:&quot;1&quot;, 
          &quot;k&quot;:&quot;GAID&quot;, 
          &quot;v&quot;: &quot;2700108e-b965-4d98-b214-274b0701725a&quot; 
        }, 
        {  
          &quot;i&quot;:&quot;2&quot;, 
          &quot;k&quot;:&quot;OMID&quot;, 
          &quot;v&quot;: &quot;cb115185-2a25-4587-8ff5-e3fe7cc7a25b&quot; 
        }
  ], 
  &quot;c&quot;: [
     { &quot;i&quot;:&quot;t&quot;, 
       &quot;c&quot;:&quot;consent2&quot;, 
       &quot;s&quot;: false 
     }, 
     { &quot;i&quot;:&quot;m&quot;, 
       &quot;c&quot;:&quot;consent2&quot;, 
       &quot;s&quot;: false 
     }
  ] 
};

xhr.open(&quot;POST&quot;, 'https://gto.&lt;yourdomain&gt;/api/v3/firstparty', true); 
xhr.withCredentials = true; 
xhr.onreadystatechange = function(response) { 
  if(xhr.readyState == XMLHttpRequest.DONE &amp;&amp; xhr.status == 200) { 
      console.log(&quot;POST response : &quot; + response.target.response); 
  } 
} 

xhr.send(JSON.stringify(params)); 
})();
</code></pre>
<p><strong>Looks heavy?</strong> Let’s open the structure of “params” a bit. It consists of three main branches:</p>
<p><strong>“e” stands for</strong> <em><strong>events</strong></em>, that is any key/value pairs that you might need to store into microprofile. Only restricted key name is “<strong>matchOnId</strong>” which we use to connect microprofiles to each other when there is e.g. hash of user email available, ie. user has logged in and microprofile can be associated to a person. Further on matchOnId has two reserved values: 1) “disconnect” allows you to disassociate microprofile from login but keep the history and 2) “reset” performs disconnect and wipes the microprofile to default stage.</p>
<p><strong>“k” stands for</strong> <em><strong>keyring</strong></em>, allowing any key/value pairs stored inside keyring. Functionality is somewhat the same as with events but adding/modifying a key is recorded with timestamp, that allows to link the consents collected to these keys (and whether the keys can be used for whatever purpose they were recorded). Keyring (“k”) has fixed structure:</p>
<p><code>"i":"keyId", -&gt; string"k":"keyName", -&gt; string"v": "keyValue" -&gt; string</code> </p>
<p>When sending requests to API you will notice that keyring items will have timestamp “t” set by the API, containing timestamp in epochtime.</p>
<p><strong>“c” stands for</strong> <em><strong>consents</strong></em>, that is to collect the consents received from CMP. Again the behavior follows the key/value pairs approach but with fixed structure:</p>
<p><code>"i":"consentId", -&gt; string"c":"consentName", -&gt; string"s":  status as true or false -&gt; bool</code></p>
<p>Same as with keyring, the timestamp of adding/modifying particular consentId is recorded and returned in API responses. This allows to monitor that when consents are changed and how those turning points connect to collected IDs in keyring (allowing or preventing further activities within integrated systems).</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Version_2/" class="btn btn-neutral float-left" title="Version 2"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../CustomerdataApi/" class="btn btn-neutral float-right" title="Customer Data API">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../Version_2/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../CustomerdataApi/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../js/modal.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
