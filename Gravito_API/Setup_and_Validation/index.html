<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Setup and Validation - Gravito Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Setup and Validation";
        var mkdocs_page_input_path = "Gravito_API\\Setup_and_Validation.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../img/logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Getting_started/Register/">Register</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Getting_started/Support/">Support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Getting_started/Release_Notes/">Release Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Consent Managment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Consent_Management/Iab_tcf/">IAB TCF</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Consent_Management/Google_consent_mode/">Google Consent Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Consent_Management/Microsoft_consent_mode/">Microsoft Consent Mode</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito CMP (New)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Setup_and_Design/">Setup and Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Customization/">Customization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Components/">Components</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Deployment/">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/FAQ/">FAQ's</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_V6_CMP/Release_Notes/">Release Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito SDK</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_SDK/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_SDK/Release_Notes/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Gravito_SDK/Version_2_%28Latest%29/">Version 2 (Latest)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito API</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Setup and Validation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#step-1-setup">Step 1 : Setup</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-2-validation">Step 2 : Validation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-3-web">Step 3 : Web</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#step-4-mobile">Step 4 : Mobile</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Version_3_%28Latest%29/">Version 3 (Latest)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Version_2/">Version 2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Microprofile/">Microprofile</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CustomerdataApi/">Customer Data API</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Other Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Other_Features/Domain_Cookie_Scan/">Domain Cookie Scan</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Other_Features/GVL_Comparison/">GVL Comparison</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Try it out</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Try_it_out/Playbooks/">Playbooks</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Gravito Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Gravito API</li>
      <li class="breadcrumb-item active">Setup and Validation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="setup-and-validation">Setup and Validation</h2>
<p>First Party domain means the domain your website operates. e.g. website.com. To avoid third party cookies being blocked (occurs already on many browsers) you can configure the CMP to set the cookies under first party domain or you can use Gravito’s first party API to store and retrieve other valuable profile data.</p>
<p>To get started with first party setup, you first need to set up domain in <a href="https://adminv2.gravito.net">Gravito’s admin panel</a></p>
<h3 id="step-1-setup">Step 1 : Setup</h3>
<p><strong>Setup of first party domain</strong></p>
<p>Once you have configured your domain gto.website.com, you need to do the DNS changes for your domain. These steps are varying between different DNS providers, generally you have to configure three records:</p>
<p><img alt="Screenshot of Gravito's DNA" src="../img/dnsentries.jpg" title="Screenshot of Gravito's DNS entries" /></p>
<h3 id="step-2-validation">Step 2 : Validation</h3>
<p><strong>First party domain configuration</strong>
After you have made the DNS records (A, TXT and CNAME), allow the changes to propagate to DNS servers (few minutes at least) and then press “Validate” button. After succesful validation you should see domain status as “Validated”:</p>
<h3 id="step-3-web">Step 3 : Web</h3>
<p><strong>Setting up on Web</strong></p>
<p>Once the DNS entries are done and validated, you can include our SDK. We have attached (as a Txt file) the sample script which for e.g. you can include inside a GTM tag.</p>
<pre><code class="language-js">function waitForOrGetVendorConsent(vendorId, callback) {
  if (typeof __tcfapi !== &quot;function&quot;) {
    return callback(new Error(&quot;__tcfapi is not available.&quot;));
  }

  // First, check if we already have the TCData available
  __tcfapi(&quot;getTCData&quot;, 2, function (tcData, success) {
    if (success &amp;&amp; tcData &amp;&amp; tcData.vendor &amp;&amp; tcData.vendor.consents) {
      var hasConsent = tcData.vendor.consents[vendorId] === true;
      // If consent string already exists and eventStatus isn't 'tcloaded', we can resolve
      if (
        tcData.eventStatus === &quot;useractioncomplete&quot; ||
        tcData.eventStatus === &quot;tcloaded&quot;
      ) {
        return callback(null, hasConsent);
      }
    }

    // Otherwise, wait for consent update via event listener
    var listener = function (updatedData, ok) {
      if (!ok || !updatedData) return;

      if (updatedData.vendor &amp;&amp; updatedData.vendor.consents) {
        var hasConsent = updatedData.vendor.consents[vendorId] === true;
        // Clean up listener
        __tcfapi(&quot;removeEventListener&quot;, 2, function () {}, listener);
        callback(null, hasConsent);
      }
    };

    __tcfapi(&quot;addEventListener&quot;, 2, listener);
  });
}

function initilizeGravitoSDK(callback) {
  try {
    window.gravitoPROCMPConfig = {
      settings: {
        sdkVersion: 3,
      },
    };
    var gravitoSDKTag = document.createElement(&quot;script&quot;);
    gravitoSDKTag.src = &quot;https://cdn.gravito.net/prosdk/latest/sdk.js&quot;;
    gravitoSDKTag.onload = function () {
      window.gravito.init(&quot;firstParty&quot;);
      gravito.state.subscribe(
        function (value) {
          // first Party is now loaded and sdk is fully initialized
          callback(null, value.firstPartyLoaded);
        },
        function (currentState, prevState) {
          return currentState.firstPartyLoaded !== prevState.firstPartyLoaded;
        }
      );
    };
    document.body.appendChild(gravitoSDKTag);
  } catch (error) {
    callback(error);
  }
}

function main() {
  var vendorId = 1347; // gravito TCF vendorId
  waitForOrGetVendorConsent(vendorId, function (error, hasConsent) {
    if (error) {
      console.error(&quot;Error checking vendor consent:&quot;, error);
      return;
    }

    if (hasConsent) {
      console.log(&quot;User has given consent for vendor ID &quot; + vendorId + &quot;.&quot;);
      // Initialize Gravito SDK
      initilizeGravitoSDK(function (err, isLoaded) {
        if (err) {
          console.error(&quot;Error initializing Gravito SDK:&quot;, err);
          return;
        }

        if (isLoaded) {
          console.log(&quot;Gravito SDK is loaded and initialized.&quot;);
          // You can now use the Gravito SDK
          var gravitoFPid = window.gravito.firstParty.profile.i;
          console.log(&quot;Gravito FP ID:&quot;, gravitoFPid);
          // Do somethign with FP id.
          // for eg. pass as the 
      });
    } else {
      console.log(&quot;User has not given consent for vendor ID &quot; + vendorId + &quot;.&quot;);
    }
  });
}
var waitPeriod = 0;
function whenAvailable(name, callback) {
  var interval = 250; // ms

  if (window[name]) {
    waitPeriod = 0;
    callback(window[name]);
    return;
  }
  if (this.waitPeriod &gt;= 1500) {
    console.error(&quot;No TCF CMP in context&quot;);
    return;
  }
  window.setTimeout(function () {
    if (window[name]) {
      waitPeriod = 0;
      callback(window[name]);
    } else {
      waitPeriod = waitPeriod + 250;
      whenAvailable(name, callback);
    }
  }, interval);
}

whenAvailable(&quot;__tcfapi&quot;, function (tcfApi) {
  console.log(&quot;TCF API is available&quot;);
  main();
});
</code></pre>
<p>For.eg. this script above basically looks for the consent of the vendor Gravito (1347) from your CMP and based on consent initiates the SDK to provision the PPIDs which you will need. </p>
<h3 id="step-4-mobile">Step 4 : Mobile</h3>
<p><strong>Setting up on mobile</strong></p>
<p>The sample repo is present here at <a href="https://github.com/GravitoLtd/gravitoAndroidFPv3">GitHub - GravitoLtd/gravitoAndroidFPv3</a>
Please go through the read me file to understand more about the implementation</p>
<p>You can use the input domains which are your  "xyz.com" and the app domain as for eg : "myapp.xyz.com" (some sub - domain)</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Getting_Started/" class="btn btn-neutral float-left" title="Getting Started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Version_3_%28Latest%29/" class="btn btn-neutral float-right" title="Version 3 (Latest)">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../Getting_Started/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Version_3_%28Latest%29/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../js/modal.js"></script>
      <script src="../../js/motomo.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
