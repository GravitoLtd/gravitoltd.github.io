<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>How to Fire GTM Tags Based on Consents in CMP? - Gravito Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "How to Fire GTM Tags Based on Consents in CMP?";
        var mkdocs_page_input_path = "Gravito_Pro_CMP\\FAQ\\How_to_fireGTM_tags_based_on_consents.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../..">
          <img src="../../../img/logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Getting_started/Register/">Register</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Getting_started/Support/">Support</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Getting_started/Release_Notes/">Release Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Consent Managment</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Consent_Management/Iab_tcf/">IAB TCF</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Consent_Management/Google_consent_mode/">Google Consent Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Consent_Management/Microsoft_consent_mode/">Microsoft Consent Mode</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito CMP (New)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_V6_CMP/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_V6_CMP/Setup_and_Design/">Setup and Design</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_V6_CMP/Customization/">Customization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_V6_CMP/Components/">Components</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_V6_CMP/Deployment/">Deployment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_V6_CMP/FAQ/">FAQ's</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_V6_CMP/Release_Notes/">Release Notes</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito SDK</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_SDK/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_SDK/Release_Notes/">Release Notes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_SDK/Version_2_%28Latest%29/">Version 2 (Latest)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gravito API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_API/Getting_Started/">Getting Started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_API/Setup_and_Validation/">Setup and Validation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_API/Version_3_%28Latest%29/">Version 3 (Latest)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_API/Version_2/">Version 2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_API/Microprofile/">Microprofile</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Gravito_API/CustomerdataApi/">Customer Data API</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Other Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Other_Features/Domain_Cookie_Scan/">Domain Cookie Scan</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Other_Features/GVL_Comparison/">GVL Comparison</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Try it out</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../Try_it_out/Playbooks/">Playbooks</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Gravito Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">How to Fire GTM Tags Based on Consents in CMP?</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="how-to-fire-gtm-tags-based-on-consents-in-cmp">How to Fire GTM Tags Based on Consents in CMP?</h1>
<blockquote>
<p>Note: This feature is only available in the PRO CMP â€“ Gravito CMP Component.</p>
</blockquote>
<p>In PRO CMP you can fire GTM tags based on the consents given by the user. This is done by configuring  the <code>gtmTags</code> field in PRO CMP config. The gtmTags field is an array of objects, where each object represents the Trigger events and its configurations which will be used to fire the GTM tags.</p>
<p>You can modify this field in either of the following ways:</p>
<ol>
<li>
<p><strong>Using Configurator</strong>:  </p>
<ul>
<li>Open the CMP configurator in the Admin Portal.  </li>
<li>Select the config from the list and click on the <strong>Copy Configuration</strong> icon/button.  </li>
<li>This will create a new CMP config with the same settings as the original one. Now enter the name on the Basic Settings page and click the <strong>Get Started</strong> button.  </li>
<li>In the left-side menu, select the <strong>Gravito CMP</strong> component.  </li>
<li>Now click on <strong>Consent Categories</strong> Tab.  </li>
<li>
<p>In this tab, you will see the <code>gtmTags</code> sections. Click the Add GTM Tags button to add a new GTM tag configuration.It will open a modal containing the following fields:  </p>
<ul>
<li><strong>Trigger Name</strong>: This is the event name which will be added to the data layer, and In GTM you can create a Custom Trigger using this event.  </li>
<li><strong>Consents</strong>: In this multi-select control you can choose the consent items to which you want to bind these events, i.e., the value of this consent will decide wether to add the above events in the dataLayer object.</li>
<li><strong>Fire Once</strong>: Check this checkbox if you want to fire the event only once in the session. In most cases you will need to keep this flag checked as you want your tag to fire once to avoid duplicate loading of tags.</li>
</ul>
</li>
<li>
<p>Once you have added the GTM tag configuration by clicking <strong>Save</strong>, you can see it in the list of GTM tags. You can add multiple GTM tags by clicking on the <strong>Add GTM Tags</strong> button again.</p>
</li>
<li>Click the <strong>Save Progress</strong> button and then click on the <strong>Publish</strong> button to publish the new config.  </li>
<li>Now when you will use this updated config in your website, it will fire GTM tags based on the consents given by the user.</li>
</ul>
</li>
</ol>
<p><img alt="" src="../../img/gtmTags.png" /></p>
<ol>
<li>
<p><strong>Without Configurator</strong>:</p>
<ul>
<li>if you are having Gravito CMP component in context then update the gtmTags field at <code>window.gravitoPROCMPConfig.gravitoCMP.core.gtmTags</code> in the config object.
below code is an example of how the gtmTags field should look like:</li>
</ul>
</li>
</ol>
<pre><code class="language-javascript">gravitoCMP: {
    core: {
        gtmTags: [
            {
                triggerName: 'Marketing Consent update', // this is the event name which will be added to the data layer
                consentIds: [3], // this will be the consent id to which this event will be bound
                fireOnce: true // this will decide whether to fire the event only once in the session or not
            },
            {
                triggerName: 'GTM Event Name 2',
                consentIds: [2],
                fireOnce: false
            }
        ]
    }
}
</code></pre>
<ul>
<li>Now when you will use this updated config in your website, it will fire GTM tags based on the consents given by the user.</li>
</ul>
<h2 id="how-this-works-internally">How this works Internally?</h2>
<p>Whenever you have this field in your config , CMP will check the consent value of the consents ids you have provided in the gtmTags field. If the consent value is true then it will add the event to the dataLayer object. So for example if you have added the gtmTags field as shown above, then CMP will add the following event to the dataLayer object if the consent value of the consent id 3 is true:</p>
<pre><code class="language-javascript">window.dataLayer.push({
    event: 'Marketing Consent update',

});
</code></pre>
<p>Now in GTM you can create a Custom Trigger using this event. So whenever the user gives consent to the consent id 3, this event will be added to the dataLayer object and you can use this event to fire your GTM tags.</p>
<h2 id="how-to-create-a-custom-trigger-in-gtm">How to create a Custom Trigger in GTM?</h2>
<ol>
<li>Open your GTM account and select the container where you want to create the trigger.</li>
<li>Click on the <strong>Triggers</strong> tab in the left-side menu.</li>
<li>Click on the <strong>New</strong> button to create a new trigger.</li>
<li>In the trigger configuration, select <strong>Custom Event</strong> as the trigger type.</li>
<li>In the <strong>Event Name</strong> field, enter the event name which you have provided in the gtmTags field in the config. For example, if you have provided <code>Marketing Consent update</code> as the event name, then enter it here.
<img alt="" src="../../img/gtmTagsTrigger.png" /></li>
<li>In the <strong>This trigger fires on</strong> section, select <strong>All Custom Events</strong> or <strong>Some Custom Events</strong> based on your requirement.</li>
<li>Now click on the <strong>Save</strong> button to save the trigger.</li>
<li>Now you can use this trigger in your GTM tags to fire them based on the consents given by the user.
<img alt="" src="../../img/gtmTagsAddTrigger.PNG" /></li>
</ol>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../js/modal.js"></script>
      <script src="../../../js/motomo.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
